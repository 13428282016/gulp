{"version":3,"names":[],"mappings":"","sources":["js/clib/player.js"],"sourcesContent":["define([\"jquery\",\"common/utils\"],function(e,t){function n(e,t,n){for(var a=[],r=3;r<arguments.length;r++)a.push(arguments[r]);return setTimeout(function(){e.apply(n,a)},t)}var a=0,r=0,i=0,o=0,s=window.ActiveXObject||document.documentMode,l={id:\"PlayerCtrl\",vt:2,mt:\"video\",mid:\"\",ap:1,ua:window.navigator.userAgent,channel:\"star\",extvar:\"\"},u=new function(){var t=this,n=[],a=!1,r=null;this.name=\"F_PLAYER_DEBUG\",this.trace=function(e,t){var a=new Date,r=a.getHours()+\":\"+a.getMinutes()+\":\"+a.getSeconds()+\".\"+a.getTime()%1e3;n.unshift(r+\"  : \"+e+\",\"+t),n=n.slice(0,1e3)},this.show=function(){a=!0,r||(r=e(\"<div>\").attr(\"id\",\"debugInfoContainer\").css({width:\"380px\",height:\"360px\",\"z-index\":\"1000\",position:\"fixed\",bottom:\"0\",background:\"#FFFFFF\",overflow:\"scroll\"}).appendTo(e(\"body\"))),r.show();for(var i=\"\",o=0;o<n.length;o++)i+=n[o]+\" <br/>\";r.html(i),t.otrace=t.trace,t.trace=function(){return\"onProgress\"==arguments[1]?!1:(t.otrace.apply(t,Array.prototype.slice.call(arguments)),void r.html(n[0]+\" <br/>\"+r.html()))}},this.hide=function(){a=!1,r.hide(),t.trace=t.otrace,delete t.otrace},this.info=function(){for(var e=\"\",t=0;t<n.length;t++)e+=n[t]+\"\\r\\n\";return e}},c=function(){this.name=\"F_PLAYER_ERROR\";var a=this,r=\"playerError\",i={101:\"Flash 初始化失败,清除浏览器缓存,再刷新页面重试\",102:'请先安装最新版本 Flash Player。<a href=\"http://get.adobe.com/cn/flashplayer/\" target=\"_blank\">立即安装</a>',103:\"没找到播放地址,请选择播放其他节目|\",104:\"接收媒体数据失败，请确认网络连接正常，再刷新页面，重试播放。|\",105:\"初始化缺少swfobject\",106:\"初始化swfobject embedSWF出错\",109:\"初始化超时\",d101s:\"接收媒体数据失败，请确认网络连接正常，再重试播放|\"},o=\"http://kkpgv2.xunlei.com/?u=vodact&u1=star_logic_error\",s=\"\",l=function(n,a,r){var i=s,l=o,r=r||\"\",u=encodeURIComponent(window.document.location.href),c=(new Date).getTime();if(s=n,a){var A={sid:0,uid:e.cookie(\"KANKANWEBUID\"),lastEvent:\"\"};this.playerInstance&&(A.sid=this.playerInstance.sid||0,A.lastEvent=this.playerInstance.lastEvent),l+=\"&u2=\"+n+\"&u3=\"+u+\"&u4=\"+A.sid+\"&u5=\"+A.uid+\"&u6=\"+A.lastEvent+\"&u7=\"+i+\"&u8=\"+r+\"&rd=\"+c}else l+=\"&u2=\"+n+\"&u3=\"+u+\"&rd=\"+c;t.sendStat(l)},c=function(t,n){var a=e(\"#\"+r);\"101\"==n||\"102\"==n?a.addClass(\"error\"):a.addClass(\"errortxt\"),a.show(),a.html('<p id=\"playerErrorContent\">'+t+\"<br/></p>\")};this.playerInstance=null,this.dump=function(e,t,r){if(u.trace(\"------ERROR-CODE:\"+e),-1!=[\"101\",\"102\",\"103\",\"104\",\"105\",\"106\"].indexOf(e)?n(l,0,a,e,!1):n(l,0,a,e,!0,r),t)return!1;if(\"undefined\"!=typeof i[e]){var o=i[e].split(\"|\");return c.call(a,o[0],e),!0}return!1}},A=function(){function n(){clearTimeout(i),o++;var t=e(\"#\"+d.playerID);return t[0]&&\"undefined\"!=typeof t[0].flv_setPlayeUrl?(d.playerLoaded=!0,u.trace(\"init flash player success\"),r=(new Date).getTime(),t.trigger(\"onload\"),void 0):void(i=setTimeout(function(){n()},50))}function c(e){!e.success}function A(t,n,a,r){var i=\"\";s?(i+='<object width=\"'+n+'\" height=\"'+a+'\" id=\"'+d.playerID+'\" classid=\"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000\"  >',i+='<PARAM NAME=\"_cx\" VALUE=\"25664\"><PARAM NAME=\"_cy\" VALUE=\"13917\"><PARAM NAME=\"FlashVars\" VALUE=\"'+r+'\">',i+='<PARAM NAME=\"Movie\" VALUE=\"'+d.playerPath+'\"><PARAM NAME=\"Src\" VALUE=\"'+d.playerPath+'\"><PARAM NAME=\"WMode\" VALUE=\"Window\">',i+='<PARAM NAME=\"Play\" VALUE=\"0\"><PARAM NAME=\"Loop\" VALUE=\"-1\"><PARAM NAME=\"Quality\" VALUE=\"High\"><PARAM NAME=\"SAlign\" VALUE=\"LT\">',i+='<PARAM NAME=\"Menu\" VALUE=\"0\"><PARAM NAME=\"Base\" VALUE=\"\"><PARAM NAME=\"AllowScriptAccess\" VALUE=\"always\"><PARAM NAME=\"Scale\" VALUE=\"NoScale\">',i+='<PARAM NAME=\"DeviceFont\" VALUE=\"0\"><PARAM NAME=\"EmbedMovie\" VALUE=\"0\"><PARAM NAME=\"BGColor\" VALUE=\"000000\"><PARAM NAME=\"SWRemote\" VALUE=\"\">',i+='<PARAM NAME=\"MovieData\" VALUE=\"\"><PARAM NAME=\"SeamlessTabbing\" VALUE=\"1\"><PARAM NAME=\"Profile\" VALUE=\"-1\"><PARAM NAME=\"ProfileAddress\" VALUE=\"\">',i+='<PARAM NAME=\"ProfilePort\" VALUE=\"830362444\"><PARAM NAME=\"AllowNetworking\" VALUE=\"all\"><PARAM NAME=\"AllowFullScreen\" VALUE=\"true\">',i+=\"</object>\"):i+='<object type=\"application/x-shockwave-flash\" id=\"'+d.playerID+'\" name=\"'+d.playerID+'\" data=\"'+d.playerPath+'\" width=\"'+n+'\" height=\"'+a+'\"><param name=\"allowScriptAccess\" value=\"always\"><param name=\"allowFullScreen\" value=\"true\"><param name=\"quality\" value=\"high\"><param name=\"bgcolor\" value=\"#000000\"><param name=\"wmode\" value=\"window\"><param name=\"flashVars\" value=\"'+r+'\"></object>',e(\"#\"+t).html(i)}var d=this;this.playerLoaded=!1,this.playerPath=\"http://js.kankan.xunlei.com/player/mp4/KKPlayer2.1_smo.swf\",this.name=\"F_PLAYER\",this.playerID=\"PlayerCtrl\",this.videoID=\"\",this.isBuffering=!1,this.lastEvent=\"init\",this.eventQueue=[0,0,0,0,0,0,0,0,0,0],this.checkSwfInterface=function(){var t=e(\"#\"+d.playerID);return\"undefined\"==typeof t.flv_setPlayeUrl?!1:!0},this.printObject=function(r,i,o,s){if(s=e.extend(l,s),!s.mid)throw\"miss video id\";if(d.playerID=s.id,d.videoID=s.mid,d.playerLoaded=!1,s=e.param(s),u.trace(\"printObject start\"),swfobject){var f={allowScriptAccess:\"always\",allowFullScreen:\"true\",quality:\"high\",bgcolor:\"#000000\"},h=t.flashVersion;h&&(10==h[0]&&h[1]>=2||h[0]>10)&&5==e.cookie(\"player_mode\")?f.wmode=\"direct\":f.wmode=\"window\",f.flashVars=s,a=(new Date).getTime();var E={id:d.playerID,name:d.playerID},p=e(\"<div>\").attr(\"id\",\"playerAtom\").css({width:\"100%\",height:\"100%\"});e(\"#\"+r).html(p),swfobject.embedSWF(d.playerPath,\"playerAtom\",i,o,\"10.2\",!1,\"\",f,E,c)}else A(r,i,o,s);n()},this.destroyObject=function(){var t=e(\"#\"+d.playerID);try{t.flv_close()}catch(n){}t.remove()},this.setLastEvent=function(e,t){d.lastEvent=e,t>0&&(d.eventQueue.unshift(t),d.eventQueue=d.eventQueue.slice(0,10))},this.getEventQueue=function(){return d.eventQueue.join(\"-\")};var f={};this.on=function(e,t){f[e]||(f[e]=[]),f[e].push(t)},this.off=function(e,t){if(f[e])for(var n,a=0,r=f[e].length;r>a;a++)n=f[e][a],n==t&&f.splice(a,1)},this.trigger=function(t,n){if(f[t])for(var a,r=0,i=f[t].length;i>r;r++)a=f[t][r],e.isFunction(a)&&a(n)}},d=new A,f=new c;return f.playerInstance=d,d.error=f,d.debug=u,window.flv_playerEvent=function(t,a,r){var i=e(\"#\"+d.playerID);if(i){if(n(u.trace,0,d,\"flv_playerEvent begin\",t),\"onbuffering\"==t){var o=d.lastEvent;d.setLastEvent(\"onBuffering\",2),d.isBuffering=!0,\"onBuffering\"==o&&f.dump(\"014\",!0),t=d.lastEvent}else if(\"onplaying\"==t)d.isBuffering=!1,d.setLastEvent(\"onPlaying\",3),t=d.lastEvent;else if(\"onPause\"==t)d.setLastEvent(\"onPause\",5);else if(\"onSeek\"==t)d.setLastEvent(\"onSeek\",4);else if(\"onopen\"==t)d.setLastEvent(\"onOpen\",1),t=d.lastEvent;else if(\"onStop\"==t){if(\"onStop\"==d.lastEvent)return!1;d.setLastEvent(\"onStop\",7)}else\"onEnd\"==t?d.setLastEvent(\"onEnd\",6):\"onError\"==t&&f.dump(a);d.trigger(t,{v1:a,v2:r})}},d});\n//# sourceMappingURL=../../maps/js/clib/player.js.map\n//# sourceMappingURL=../../maps/js/clib/player.js.map"],"file":"js/clib/player.js","sourceRoot":"/source/"}