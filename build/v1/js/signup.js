require(["jquery","birthday","common/utils","common/validate","common/header","common/pay"],function(n,i,t,e,a,o){var s=t.cookie,c=a.userInfo,d={type:"star",payAmount:"12",payType:"E"},r={getStarInfo:"http://backend.star.kankan.com/star_info"},u="bk4kk";t.createBK4KKIfr(u,"http://backend.star.kankan.com/post"),a.addLogoutCallback(function(){window.location="http://star.kankan.com"});var f=(new Date).getTime(),l=new function(){function i(){"undefined"==typeof c.star_info?a.addCheckBackendCallback(o):o()}function o(){if(c.is_star)if(0==c.star_info.status){var i="http://api.star.kankan.com/star_info?a=info&jsoncallback=?";n.getJSON(i,function(n){if(200==n.status){var i=n.data.star_info;m.find("input[name=name]").val(i.name),m.find("input[name=identity]").val(i.identity),m.find("input[name=contact]").val(i.contact),m.find("select[name=sex]").val(i.sex);var t=i.birthday.split("-");m.find("select[name=year]").val(t[0]),m.find("select[name=month]").val(t[1]),m.find("select[name=day]").val(t[2])}})}else 1==c.star_info.status&&n.isFunction(d)&&d()}var s=this,d=function(){},l=function(){},m=n("form[name=reg_form]");this.init=function(){i(),m.find("a.btn-next").on("click",function(){var i=m.find("input[name=name]").val(),t=m.find("input[name=identity]").val(),a=m.find("input[name=contact]").val(),o=m.find("select[name=sex]").val(),d=m.find("select[name=year]").val(),r=m.find("select[name=month]").val(),u=m.find("select[name=day]").val();return c.logined?e.required(i)?e.required(t)&&e.isIdCard(t)?e.required(a)&&e.isCellphone(a)?!e.required(o)||"1"!=o&&"2"!=o?void alert("性别必选"):e.required(d)&&0!=d?e.required(r)&&0!=r?e.required(u)&&0!=u?void s.post():void alert("日必选"):void alert("月必选"):void alert("年必选"):void alert("手机号无效"):void alert("身份证号无效"):void alert("姓名必填"):void(n.isFunction(window.login)&&window.login())}),n("#birthday").birthday()},this.post=function(){var i=m.serialize();t.sendKkpgvC("signup","post",f),t.ajaxBK4KK(u,r.getStarInfo,i,function(i){200==i.status?n.isFunction(l)&&l():alert(i.data.msg)})},this.show=function(){n("#regForm").show()},this.hide=function(){n("#regForm").hide()},this.success=function(n){d=n},this.fail=function(n){l=n}},m={show:function(){n("#successNotice").show().find("p span").text(s.get("usernick"))},hide:function(){n("#successNotice").hide()}};setTimeout(function(){l.init(),l.success(function(){l.hide(),m.show()}),l.fail(function(){t.sendKkpgvC("signup","pay",f);var n=new o({payDesc:"=1年看看会员 + 网络艺人传奇之路 = 180元",payInfo:d,success:function(){t.sendKkpgvC("signup","payDone",f),c.checkBackend(),l.hide(),m.show()}});n.openDialog()})},0)});
//# sourceMappingURL=../maps/js/signup.js.map
//# sourceMappingURL=../maps/js/signup.js.map
//# sourceMappingURL=../js/maps/js/signup.js.map