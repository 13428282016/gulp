require(["jquery","common/header","common/flower","common/grade","common/invest","common/type_to_text","common/talent_player","common/utils"],function(t,n,e,a,i,o,r,s){var c={recentNewsUrl:"http://api.star.kankan.com/user_info?a=actions",rankInfoUrl:"http://api.star.kankan.com/star_info?a=hit_invest_info",gradeInfoUrl:"http://api.star.kankan.com/star_info?a=rating",dynamicNum:10,init:function(){var o=this,s={id:this.getStarId(),name:this.getStarName(),portrait:this.getPortraitUrl()},c=new e({target:s,success:function(n,e){t("#week_hit, #total_hit").each(function(){t(this).text(parseInt(t(this).text())+parseInt(e.info.present))}),t("#total_hit_rank").text(n.data.starRank),t("#week_hit_rank").text(n.data.starWeekRank),o.loadRecentNews(e.target.id)}}),d=new a({target:s,success:function(t,n){var e=t.data;o.setGradeInfo(e.appearance,e.potential,e.rates_count),o.loadRecentNews(s.id)}}),l=new i({target:s}),u=new r;t(".grade-btn").click(function(){return n.userInfo.logined?void d.openDialog():void(t.isFunction(window.login)&&window.login())}),t(".invest-btn").click(function(){return n.userInfo.logined?void l.investor(n.userInfo.is_investor):void(t.isFunction(window.login)&&window.login())}),t(".flower-btn").click(function(){return n.userInfo.logined?void c.openDialog():void(t.isFunction(window.login)&&window.login())}),t("div.skill-show ul > li").on("click","a[videoid]",function(n){var e=t(this).attr("videoid"),a=t(this).next().text();e&&u.play(e,a)}),this.flower=c,this.grade=d,this.invest=l,this.id=this.getStarId(),this.loadRecentNews(this.id),this.loadRankInfo(this.id),this.loadGradeInfo(this.id)},setGradeInfo:function(n,e,a){t("#appearance").text(n?n:"暂无评"),t("#potential").text(e?e:"暂无评"),t(".grade-num").text(parseInt(a)),t("#appearance_bg").css("width",10*n+"%"),t("#potential_bg").css("width",10*e+"%")},getPortraitUrl:function(){return t(".photo img").attr("src")},getStarName:function(){return t("input[type=hidden].name").val()},getStarId:function(){return t("input[type=hidden].id").val()},loadGradeInfo:function(n){var e=this;t.ajax({url:e.gradeInfoUrl,dataType:"jsonp",data:{userid:n},method:"GET",jsonp:"jsoncallback",success:function(t){if(200==t.status){var n=t.data;e.setGradeInfo(n.appearance,n.potential,n.rates_count)}}})},loadRankInfo:function(n){var e=this;t.ajax({url:e.rankInfoUrl,dataType:"jsonp",data:{userid:n},method:"GET",jsonp:"jsoncallback",success:function(n){if(200==n.status){var e=n.data;t("#total_hit_rank").text(e.hit.rank),t("#total_hit").text(s.moneyFormat(e.hit.score)),t("#week_hit_rank").text(e.hit_week.rank),t("#week_hit").text(s.moneyFormat(e.hit_week.score)),t("#invest_total_money").text(s.moneyFormat(e.invest.score)),t("#invest_name").text(e.invest.leader)}}})},loadRecentNews:function(n){t.ajax({url:this.recentNewsUrl,dataType:"jsonp",data:{userid:n},method:"GET",jsonp:"jsoncallback",success:function(n){if(200==n.status){var e="",a=n.data;for(var i in a){if(i>=this.dynamicNum)break;e+=o.userActionMsg(a[i])}t("div.dynamic ul").html(e)}}})}};t(function(){c.init()})});
//# sourceMappingURL=../../maps/js/star/homepage.js.map
//# sourceMappingURL=../../maps/js/star/homepage.js.map
//# sourceMappingURL=../../js/maps/js/star/homepage.js.map